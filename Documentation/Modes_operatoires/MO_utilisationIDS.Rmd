---
title: "Description de la base données"
author: "Jean-Baptiste Paroissien"
date: "16/12/2016"
output:
  html_document:
    fig_caption: yes
    highlight: zenburn
    number_sections: yes
    theme: spacelab
    toc: yes
rerCat: entrepot
tags: Utilisation de l'entrepot
categories: entrepot
---

# Objectif et domaine d'application
L'objectif de ce mode opératoire est d'aider les utilisateurs à naviguer dans l'Infrastructure de données Spatiales (IDS) geOrchestra. Le document présente l'IDS dans sa globalité et les différentes fonctionnalités intégrées.

| Type utilisateur | Systèmes d'exploitation | Langages/logiciels |
|------------------|-------------------------|--------------------|
| Utilisateur      | Linux & Windows         | Navigateur web     |

# Présentation de l'IDS geOrchestra

La plate forme de diffusion des webservices et des métadonnées est basée sur geOrchestra. geOrchestra est un logiciel composé de briques logicielles indépendantes accessibles en partie en cliquant sur les onglets mis en valeur dans l'encadré 2 de la figure ci-dessous :

- services : renvoie vers le GeoServer, serveur de données cartographiques
- catalogue : renvoie vers le GeoNetwork, le gestionnaire de métadonnées
- visualiseur : Mapfishapp, un service de visualisation de webservices

En tant qu'utilisateur, vous utiliserez uniquement le service catalogue et le visualiseur

## Adresse
Pour le moment, il existe plusieurs IDS : 

- Une IDS en développement (dit en "bac à sable") est utilisée pour les tests d'intégration de données. Elle se trouve à nancy et et son adresse est la suivante : [http://ids-bas-portail.nancy.inra.fr/mapfishapp/](http://ids-bas-portail.nancy.inra.fr/mapfishapp/)
- Une IDS en production sera bientôt créée, son adresse n'est pas encore connue.

# Les différents outils de l'IDS geOrchestra

Une partie de la documentation provient de deux documents de GéoBretagne consultables [ici](http://cms.geobretagne.fr/sites/default/files/documents/GeOchestra_Mode_emploi_Visualiseur_V2.odt) et [là](http://cms.geobretagne.fr/sites/default/files/documents/GeOchestra_Mode_emploi_Extracteur_V2.pdf). Ils sont complets, n'hésitez-pas à les consulter pour plus de détails sur l'utilisation de geOrchestra.

## Visualisation
Le visualiseur de geOrchestra comporte un ensemble d'outils qui facilite la navigation des couches cartographiques. L'utilisation de ces outils est intuitive et la prise en main rapide. La figure ci-dessous présente les principaux éléments du visualiseur :

![](Figures/utilisation_visualiseur.png)

1. Outils de zoom, de déplacement, de mesure et d’impression
2. Choix de l'outil à consulter
3. Aide en ligne, légende, Outils et espace de travail d’enregistrement
4. Travail sur les couches d’informations présentes (chargement de nouvelles couches, gestion de la transparence...)
5. Pour se connecter et accéder aux services de l'administrateur
6. Géolocalisation grâce à Geonames, par référentiel ou par adresse
7. Changement d’échelle

### Ajouter une nouvelle couche

Le visualiseur peut interroger différents types de webservices à travers plusieurs méthodes. En cliquant sur le bouton `Ajouter des couches` (encadré 4), vous accédez à l'aperçu de la figure ci-dessous :

![](Figures/ajout_couche.png)

Voici un descriptif des différents onglets proposés :

- Catalogue de métadonnées : Permet d'intérroger et de charger un webservice présents dans les différents catalogues de la communauté
- Thésaurus : Charger un webservice en fonction d'un thésaurus
- Serveurs WTMS : Ajouter un webservice présent dans un serveur WMTS (Web Map Tile Service). Plusieurs serveurs sont pré-enregistrés et il est possible de saisir une adresse d'un WMTS
- Serveur WMS : Ajouter un webservice présent dans un serveur WMS (Web Map Service). Plusieurs serveurs sont pré-enregistrés et il est possible de saisir une adresse d'un WMTS
- Serveur WFS : Ajouter un webservice présent dans un serveur WFS (Web Feature Service). Plusieurs serveurs sont pré-enregistrés et il est possible de saisir une adresse d'un WFS
- Fichier : Ajout d'un fichier (Shapefiles par exemple) 

Par exemple, pour visualiser une couche présente dans le catalogue de l'IDS 

- Cliquez sur **Ajouter couche** et sélectionnez l'onglet **Catalogue** :
- Sélectionnez le catalogue local
- Cliquez sur la couche à ajouter

**Important :** Vous pouvez accéder à la fiche de métadonnée de la couche affichée en cliquant sur le 'plus' dans la fenêtre des couches à ajouter (voir image ci-dessus)

### Partager une carte 

Une fois la carte chargée, il est possible de la partager en utilisant un Web Map Context (WMC). C'est un protocole de communication standardisé pour le partage de carte. Il permet de stocker, de réutiliser voire de diffuser des contextes d'utilisation d'un WMS. Le contexte contient toutes les informations utiles pour remettre un utilisateur dans les mêmes conditions de travail que lorsqu'il l'a enregistré (liste des couches, styles utilisés, ordre, taille de fenêtre, étendue...).
L'onglet `Espace de travail` (voir point 3 de la figure 1) propose plusieurs options basées sur ce protocole :

- Sauvegarder la carte : Cette option permet de sauvegarder votre espace de travail sous un fichier `.wmc`. Ce fichier peut être envoyé, l'utilisateur recevant ce fichier peut l'ouvrir en cliquant sur l'option `Charger une carte`.
- Charger une carte : Permet de charger une carte provenant d'un fichier wmc.
- Obtenir une permalien : Permet de créer un permalien de la carte créée. En cliquant sur cette option, vous créez une url qui renvoie vers le visualiseur de l'IDS avec le rendu de votre carte
- Partager cette carte : Cette option renvoie vers deux sous-options :
* Visualiseur mobile : pour visualiser la carte dans un visualiseur plus simple (sviewer). Ici aussi, vous pouvez partager ce rendu en copiant/collant l'url affichée par votre navigateur.
* Visualiseur web : de la même façon, mais renvoie vers un visualiseur mapfishapp complet.
- Editer dans OSM : Option pour éditer des couches OpenStreetMap (OSM).


## Catalogue 

Le catalogue est accessible dans l'onglet en haut à gauche de la page, en cliquant sur **catalogue**. Il permet de consulter les fiches de métadonnées des couches incluses dans l'IDS. Un outil de recherche est disponible en haut à gauche permettant de trouver un webservice et sa fiche de métadonnée avec un mot clé comme par exemple : le nom de la couche, le type de donnée diffusée ou encore l'élément chimique cartographié. Voici un exemple avec le mot-clé '**plomb**' :

![](Figures/catalogue_IDS.jpg)
 
- Le moteur de recherche montre les différentes fiches de métadonnées associées au mot-clé '**plomb**'
- En cliquant sur l'une d'elle, on peut accéder à la fiche de métadonnée et également visualiser la donnée en cliquant sur le nom de la couche, ici 'teneur_pb_ext_rmqs'
- Il est possible d'extraire la fiche de métadonnée sous différents formats en cliquant sur **Actions**, **Export pdf** par exemple
![](Figures/ids_catalogue2.jpg)

